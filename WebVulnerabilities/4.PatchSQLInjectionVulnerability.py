# patch the following code so it's no longer susceptible to SQL injections:

import sqlite3

with sqlite3.connect('db.sqlite3') as connection:
    cursor = connection.cursor()
    cursor.execute('CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY, username TEXT, password TEXT)')
    cursor.execute('INSERT OR IGNORE INTO users VALUES (1, "alice", "1234")')
    cursor.execute('INSERT OR IGNORE INTO users VALUES (2, "bob", "5678")')

def authenticate(username, password):
    with sqlite3.connect('db.sqlite3') as connection:
        cursor = connection.cursor()
        # the following line is that we need to patch
        #cursor.execute("SELECT * FROM users WHERE username = '{}' AND password = '{}'".format(username, password)) # change this line only
        cursor.execute("""SELECT * FROM users WHERE username =(?)  AND password = (?)""", (password,username,)) # change this line only
        return len(cursor.fetchall()) > 0


def hack():
    username, password = sql_injection()
    return authenticate(username, password)

def sql_injection():
    return ("diego", "' OR 1==1;--")
print(hack())